<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>首页</title>
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="css/base.css" />
		<link rel="stylesheet" type="text/css" href="layui/css/layui.css" />
	</head>

	<body>
		<div class="body">
			<div class="header">
				<div class="navbg">
					<div class="nav center">
						<ul class="layui-nav dplayinlineB" lay-filter="" id="classList">
							<li class="layui-nav-item layui-this">
								<a href="javascript:void(0);">Java</a>
							</li>
							<li class="layui-nav-item" id="web">
								<a href="javascript:void(0);">Web</a>
							</li>
							<li class="layui-nav-item">
								<a href="javascript:void(0);">Android</a>
							</li>
							<li class="layui-nav-item">
								<a href="javascript:void(0);">PHP</a>
							</li>
							<!--<li class="layui-nav-item"><a href="javascript:void(0);">JavaScript</a></li>-->
							<!--<li class="layui-nav-item"><a href="###">算法分析</a></li>-->
						</ul>

						<div class="search dplayinlineB">
							<a href="###" class="dplayinlineB" id="search"><i class="layui-icon">&#xe615;</i></a>
							<input type="text" name="search" required lay-verify="required" autocomplete="off" class="layui-input dplayinlineB" placeholder="请输入关键字">
						</div>
						<div class="layui-clear"></div>

					</div>
				</div>
				<div class="slide center">
					<div class="layui-carousel" id="slider">
						<div carousel-item="">
							<div>
								<div class="img"></div>
							</div>
							<div>
								<div class="img"></div>
							</div>
							<!--<div><div class="img"></div></div>-->
						</div>
					</div>
				</div>

			</div>

			<div class="layui-clear"></div>

			<div class="main">
				<div class="main-top">
					<span class="blog-name">RoyRocco的博客</span>
					<a href="###">
						<i class="layui-icon">&#xe65c;</i>退出登录
					</a>
					<a href="###">
						<i class="layui-icon">&#xe642;</i>修改个人信息
					</a>
				</div>
				<div class="main-body">
					<div class="main-left" id="main-left">
						<ul id="listContent">
							<!--<li class="blog-unit">
								<h3 class="blog-title"><a href="">随便想一个标题来填充吧</a></h3>
								<div class="unit-contorl">
									<span>来源：</span><span id="from">CSDN</span>
									<span>分类：</span><span id="class">Java</span>
									<span id="time">2017-12-31 14:49:59</span>
									<span class="unit-con-right">
										<a href="###">收藏</a>
										<a href="###">查看</a>
									</span>
									
								</div>
							</li>-->
						</ul>

						<div class="page">
							<div id="page"></div>
						</div>

					</div>

					<div class="main-right">
						<!--收藏 关注 笔记-->
						<div class="user-info">
							<dl class="info-bar">
								<dt class="info-pic"><img src="img/4.jpg" alt="" /></dt>
								<dd class="info-name">
									<p>RoyRocco</p>
								</dd>
							</dl>
							<div class="info-number">
								<a href="###" class="my-index">个人主页</a>

								<dl>
									<dt>关注</dt>
									<dd>28</dd>
								</dl>
								<dl>
									<dt>收藏</dt>
									<dd>218</dd>
								</dl>
								<!--<dl>
									<dt>笔记</dt><dd>8</dd>
								</dl>-->

							</div>
						</div>

						<div class="hot">
							<p>热点推荐</p>
							<ul>
								<li>
									<a href="">这是标题这是标题这是标题这是标题这是标题这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
							</ul>
						</div>

						<div class="inter">
							<p>兴趣推荐</p>
							<ul>
								<li>
									<a href="">这是标题这是标题这是标题这是标题这是标题这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
								<li>
									<a href="">这是标题</a>
								</li>
							</ul>
						</div>

					</div>
				</div>
			</div>

			<div class="footer"></div>
		</div>

	</body>
	<script src="js/jquery-3.0.0.min.js" charset="utf-8"></script>
	<script src="layui/layui.js" type="text/javascript" charset="utf-8"></script>
	<script>
		layui.use('element', function() {
			var element = layui.element;
		});
		layui.use('carousel', function() {
			var carousel = layui.carousel;
			//建造实例
			carousel.render({
				elem: '#slider',
				width: '100%',
				height: '500px',
				anim: 'fade',
				arrow: 'hover',
				autoplay: '!true',
				indicator: 'none'
			});
		});

		var type = 1;
		var listData;
		fillData(1, 1);
		var length = listData.length;
		createPage(length);

		//分类切换
		$('#classList li').click(function() {
			var _index = $(this).index();
			type = (_index + 1);
			fillData(type, 1);
			var length = listData.length;
			createPage(length);
		});

		//搜索  http://localhost:88//blogSpD/index.html###
		$('#search').click(function() {
			var keyword = $('input[name=search]');
//			var searchData = $('#keyword');
			var isNull = keyword.val().trim().replace(/\s/g, "");
			if(isNull == null || isNull == "" || isNull == ' ') {
				alert('搜索关键字不能为空');
				keyword.val('');
				keyword.focus();
			} 
//else {
//				var keyword = keyword.val();
//				$.ajax({
//					async: false,
//					type: "post",
//					url: "searchInfo.php",
//					data: {
//						type: type,
//						keyword: keyword
//					},
//					success: function(response, status, xhr) {
//						datas = JSON.parse(response);
//						searchDeal(datas);
//					}
//				});
//			}
		});

		//填充列表内容
		function fillData(type, page) {
			getArticle(type);
			var type = type;
			var pageEnd;
			var pageStart = (page - 1) * 10;
			var length = listData.length;
			var isEnd = Math.ceil(length / 10);
			if(page == isEnd) {
				pageEnd = length;
			} else {
				pageEnd = page * 10;
			}
			var types = ['', 'Java', 'Web', 'Android', 'PHP'];

			$('#listContent').html('');

			for(var i = pageStart; i < pageEnd; i++) {
				var list = '<li class="blog-unit"><h3 class="blog-title"><a href="">' + listData[i].title + '</a></h3><div class="unit-contorl"><span>来源：</span><span id="from">' + listData[i].from + '</span><span>分类：</span><span id="class">' + types[type] + '</span><span id="time">2017-12-31 14:49:59</span><span class="unit-con-right"><a href="###">收藏</a><a href="###">查看</a></span></div></li>';
				$('#listContent').append(list);
			}

		}

		//获取文章内容
		function getArticle(type) {
			var type = type;
			var page = page;
			$.ajax({
				async: false,
				url: "getArticleTitle.php",
				type: "POST",
				data: {
					type: type
				},
				success: function(response, status, xhr) {
					listData = JSON.parse(response);
				}
			});
		}

		//分页
		function createPage(totalPages) {
			var totalPages = totalPages;
			layui.use('laypage', function() {
				var laypage = layui.laypage;
				//执行一个laypage实例
				laypage.render({
					elem: 'page', //注意，这里的 test1 是 ID，不用加 # 号
					count: totalPages, //数据总数，从服务端得到
					jump: function(obj, first) {
						//首次不执行
						if(!first) {
							fillData(type, obj.curr);
						}
					}
				});
			});
		}

		//广告图展示
		var imgPath = ['img/5.jpg', 'img/6.jpg'];
		var img = $('#slider .img');
		for(var i = 0; i < img.length; i++) {
			img[i].style.backgroundImage = 'url(' + imgPath[i] + ')';
		}
	</script>

</html>